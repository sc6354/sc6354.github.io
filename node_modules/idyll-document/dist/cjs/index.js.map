{"version":3,"file":"index.js","sources":["../../src/utils/schema2element.js","../../src/components/placeholder.js","../../src/components/author-tool.js","../../src/utils/index.js","../../src/runtime.js","../../src/index.js"],"sourcesContent":["import React, { createElement } from 'react';\nimport DOM from 'react-dom-factories';\nimport { paramCase, pascalCase } from 'change-case';\n\nconst _componentMap = new WeakMap();\n\nclass ReactJsonSchema {\n  constructor(componentMap) {\n    if (componentMap) this.setComponentMap(componentMap);\n  }\n\n  parseSchema(schema) {\n    let element = null;\n    let elements = null;\n    if (Array.isArray(schema)) {\n      elements = this.parseSubSchemas(schema);\n    } else {\n      element = this.createComponent(schema);\n    }\n    return element || elements;\n  }\n\n  parseSubSchemas(subSchemas = []) {\n    const Components = [];\n    let index = 0;\n    for (const subSchema of subSchemas) {\n      if (typeof subSchema === 'string') {\n        Components.push(subSchema);\n      } else {\n        subSchema.key =\n          typeof subSchema.key !== 'undefined' ? subSchema.key : index;\n        Components.push(this.parseSchema(subSchema));\n        index++;\n      }\n    }\n    return Components;\n  }\n\n  createComponent(schema) {\n    if (schema.type) {\n      if (schema.type === 'textnode') return schema.value;\n    }\n    const { component, children, ...rest } = schema;\n    const Component = this.resolveComponent(schema);\n    const Children = this.resolveComponentChildren(schema);\n    return createElement(Component, rest, Children);\n  }\n\n  resolveComponent(schema) {\n    const componentMap = this.getComponentMap();\n    let Component;\n    // bail early if there is no component name\n    if (!schema.hasOwnProperty('component')) {\n      throw new Error(\n        'ReactJsonSchema could not resolve a component due to a missing component attribute in the schema.'\n      );\n    }\n\n    // if it's already a ref bail early\n    if (schema.component === Object(schema.component)) {\n      return schema.component;\n    }\n\n    const [name, ...subs] = schema.component.split('.');\n\n    // find the def in the provided map\n    if (componentMap) {\n      Component = componentMap[name];\n      if (!Component) Component = componentMap[paramCase(name)];\n      if (!Component) Component = componentMap[pascalCase(name)];\n\n      for (let i = 0; i < subs.length; i++) {\n        Component = Component.default[subs[i]] || Component[subs[i]];\n      }\n    }\n\n    // if still nothing found it's a native DOM component or an error\n    if (!Component) {\n      if (DOM.hasOwnProperty(name)) {\n        Component = schema.component;\n      } else {\n        console.warn(\n          `Could not find an implementation for: ${schema.component}`\n        );\n        return () => (\n          <div style={{ color: 'black', border: 'solid 1px red' }}>\n            <pre>Could not find an implementation for: {schema.component}</pre>\n          </div>\n        );\n      }\n    }\n\n    // if there is a default prop (CommonJS) return that\n    return Component.default || Component;\n  }\n\n  resolveComponentChildren(schema) {\n    const children = schema.hasOwnProperty('children')\n      ? this.parseSchema(schema.children)\n      : [];\n    return children.length ? children : undefined;\n  }\n\n  getComponentMap() {\n    return _componentMap.get(this);\n  }\n\n  setComponentMap(componentMap) {\n    _componentMap.set(this, componentMap);\n  }\n}\n\nexport default ReactJsonSchema;\n","import React from 'react';\n\nexport const generatePlaceholder = (name) => {\n  return class extends React.PureComponent {\n    constructor(props) {\n      super(props);\n      console.warn(`Warning: attempting to use component named ${name}, but it wasn't found`);\n    }\n\n    render() {\n      const { idyll, updateProps, hasError, ...props } = this.props;\n      return <div {...props} />;\n    }\n  }\n}\n","import React from 'react';\nimport ReactTooltip from 'react-tooltip';\n\nclass AuthorTool extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isAuthorView: false,\n      debugHeight: 0,\n      componentHeight: 0,\n      hasPressedButton: false\n    };\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  // For all available props in metaValues, display them\n  // If runtimeValues has a value for given prop, display it\n  // Returns this in a single table row <tr>\n  handleTableValues(metaValues, runtimeValues) {\n    return metaValues.props.map(prop => {\n      const runtimeValue = runtimeValues.props[prop.name];\n      let currentPropValue = null;\n      if (runtimeValue !== undefined) {\n        if (\n          runtimeValue &&\n          {}.toString.call(runtimeValue) === '[object Function]'\n        ) {\n          currentPropValue = <em>function</em>;\n        } else {\n          currentPropValue = runtimeValue;\n        }\n      }\n      return (\n        <tr key={JSON.stringify(prop)} className=\"props-table-row\">\n          <td>{prop.name}</td>\n          <td className=\"props-table-type\">{prop.type}</td>\n          <td>{prop.example}</td>\n          <td>{currentPropValue}</td>\n        </tr>\n      );\n    });\n  }\n\n  // Returns authoring information for the prop values in table format\n  // and includes a link to the docs page at the bottom\n  handleFormatComponent(runtimeValues) {\n    const metaValues = runtimeValues.type._idyll;\n    const componentName = metaValues.name;\n\n    // Docs use lowercase component name for link\n    const componentLowerCase =\n      componentName.charAt(0).toLowerCase() + componentName.slice(1);\n    const componentDocsLink =\n      'https://idyll-lang.org/docs/components/default/' + componentLowerCase;\n\n    const showProps = this.handleTableValues(metaValues, runtimeValues);\n    const { isAuthorView, debugHeight, componentHeight } = this.state;\n    const currentDebugHeight = isAuthorView ? debugHeight : 0;\n    const marginToGive = isAuthorView ? 15 : 0;\n    // If a component's height is too small, button will overlap with table\n    // so add margin to get a minimal height (40px seems fine)\n    const marginAboveTable =\n      componentHeight < 40 && isAuthorView ? 40 - componentHeight : 0;\n    return (\n      <div\n        className=\"debug-collapse\"\n        style={{\n          height: currentDebugHeight + 'px',\n          marginBottom: marginToGive + 'px',\n          marginTop: marginAboveTable + 'px'\n        }}\n      >\n        <div\n          className=\"author-component-view\"\n          ref={inner => (this.innerHeight = inner)}\n        >\n          <table className=\"props-table\">\n            <tbody>\n              <tr className=\"props-table-row\">\n                <th>Prop</th>\n                <th>Type</th>\n                <th>Example</th>\n                <th>Current Value</th>\n              </tr>\n              {showProps}\n            </tbody>\n          </table>\n          <div className=\"icon-links\">\n            <a className=\"icon-link\" href={componentDocsLink}>\n              <img\n                className=\"icon-link-image\"\n                src=\"https://raw.githubusercontent.com/google/material-design-icons/master/action/svg/design/ic_description_24px.svg?sanitize=true\"\n              />\n            </a>\n            <a className=\"icon-link\" href={componentDocsLink}>\n              <span\n                style={{\n                  fontFamily: 'courier',\n                  fontSize: '12px',\n                  marginTop: '8px'\n                }}\n              >\n                docs\n              </span>\n            </a>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Flips between whether we are in the author view of a component\n  handleClick() {\n    this.setState(prevState => ({\n      isAuthorView: !prevState.isAuthorView,\n      debugHeight: this.innerHeight.getBoundingClientRect().height\n    }));\n    if (!this.state.hasPressedButton) {\n      this.setState({\n        componentHeight: this._refContainer.getBoundingClientRect().height,\n        hasPressedButton: true\n      });\n    }\n  }\n\n  // Returns an entire author view, including the component itself,\n  // a quill icon to indicate whether we're hovering in the component,\n  // and debugging information when the icon is pressed\n  render() {\n    const { idyll, updateProps, hasError, ...props } = this.props;\n    const addBorder = this.state.isAuthorView\n      ? {\n          boxShadow: '5px 5px 10px 1px lightGray',\n          transition: 'box-shadow 0.35s linear',\n          padding: '0px 10px 10px',\n          margin: '0px -10px 20px'\n        }\n      : null;\n    const putButtonBack = this.state.isAuthorView\n      ? {\n          right: '10px',\n          top: '3px'\n        }\n      : null;\n\n    return (\n      <div\n        className=\"component-debug-view\"\n        style={addBorder}\n        ref={ref => (this._refContainer = ref)}\n      >\n        {props.component}\n        <button\n          className=\"author-view-button\"\n          style={putButtonBack}\n          onClick={this.handleClick}\n          data-tip\n          data-for={props.uniqueKey}\n        />\n        <ReactTooltip\n          className=\"button-tooltip\"\n          id={props.uniqueKey}\n          type=\"info\"\n          effect=\"solid\"\n          place=\"bottom\" // TODO not showing up ?\n          disable={this.state.isAuthorView}\n        >\n          <div className=\"tooltip-header\">\n            {props.authorComponent.type._idyll.name} Component\n          </div>\n          <div className=\"tooltip-subtitle\">Click for more info</div>\n        </ReactTooltip>\n        {this.handleFormatComponent(props.authorComponent)}\n      </div>\n    );\n  }\n}\n\nexport default AuthorTool;\n","import falafel from 'falafel';\nimport { parse } from 'csv-parse/sync';\n\nconst {\n  cloneNode,\n  getChildren,\n  getNodeName,\n  getNodeType,\n  getProperties,\n  isTextNode,\n  removeNodes\n} = require('idyll-ast');\n\nconst isPropertyAccess = node => {\n  const index = node.parent.source().indexOf(`.${node.name}`);\n  if (index === -1) {\n    return false;\n  }\n  const proxyString = '__idyllStateProxy';\n  if (index >= proxyString.length) {\n    if (\n      node.parent\n        .source()\n        .substr(index - proxyString.length, proxyString.length) === proxyString\n    ) {\n      return false;\n    }\n  }\n  return true;\n};\n\nconst isObjectKey = node => {\n  return node.parent.type === 'Property' && node.parent.key === node;\n};\n\nexport const buildExpression = (acc, expr, isEventHandler) => {\n  let identifiers = [];\n  let modifiedExpression = '';\n\n  try {\n    modifiedExpression = falafel(\n      isEventHandler ? expr : `var __idyllReturnValue = ${expr || 'undefined'}`,\n      node => {\n        switch (node.type) {\n          case 'Identifier':\n            const skip = isPropertyAccess(node) || isObjectKey(node);\n            if (Object.keys(acc).indexOf(node.name) > -1) {\n              identifiers.push(node.name);\n              if (!skip) {\n                node.update('__idyllStateProxy.' + node.source());\n              }\n            }\n            break;\n        }\n      }\n    );\n  } catch (e) {\n    console.error(e);\n  }\n\n  if (!isEventHandler) {\n    return `\n    ((context) => {\n      var __idyllStateProxy = new Proxy({}, {\n        get: (_, prop) => {\n          return context[prop];\n        },\n        set: (_, prop, value) => {\n          console.warn('Warning, trying to set a value in a property expression.');\n        }\n      });\n      ${modifiedExpression};\n      return __idyllReturnValue;\n    })(this)`;\n  }\n\n  return `\n    ((context) => {\n        var __idyllExpressionExecuted = false;\n        var __idyllStateProxy = new Proxy({\n          ${identifiers\n            .map(key => {\n              return `${key}: ${\n                key !== 'refs'\n                  ? `context.__idyllCopy(context['${key}'])`\n                  : `context['${key}']`\n              }`;\n            })\n            .join(', ')}\n        }, {\n          get: (target, prop) => {\n            return target[prop];\n          },\n          set: (target, prop, value) => {\n            if (__idyllExpressionExecuted) {\n              var newState = {};\n              newState[prop] = value;\n              context.__idyllUpdate(newState);\n            }\n            target[prop] = value;\n            return true;\n          }\n        });\n        ${modifiedExpression};\n        context.__idyllUpdate({\n          ${identifiers\n            .filter(key => key !== 'refs')\n            .map(key => {\n              return `${key}: __idyllStateProxy['${key}']`;\n            })\n            .join(', ')}\n        });\n        __idyllExpressionExecuted = true;\n    })(this)\n  `;\n};\n\nexport const evalExpression = (acc, expr, key, context) => {\n  const isEventHandler =\n    key && (key.match(/^on[A-Z].*/) || key.match(/^handle[A-Z].*/));\n  let e = buildExpression(acc, expr, isEventHandler);\n  if (isEventHandler) {\n    return function() {\n      eval(e);\n    }.bind(\n      Object.assign({}, acc, context || {}, {\n        __idyllCopy: function copy(o) {\n          if (typeof o !== 'object') return o;\n          var output, v, key;\n          output = Array.isArray(o) ? [] : {};\n          for (key in o) {\n            v = o[key];\n            output[key] = typeof v === 'object' ? copy(v) : v;\n          }\n          return output;\n        }\n      })\n    );\n  }\n\n  try {\n    return function(evalString) {\n      try {\n        return eval('(' + evalString + ')');\n      } catch (err) {\n        console.warn('Error occurred in Idyll expression');\n      }\n    }.call(Object.assign({}, acc), e);\n  } catch (err) {}\n};\n\nexport const getVars = (arr, context = {}) => {\n  const formatAccumulatedValues = acc => {\n    const ret = {};\n    Object.keys(acc).forEach(key => {\n      const accVal = acc[key];\n      if (\n        typeof accVal.update !== 'undefined' &&\n        typeof accVal.value !== 'undefined'\n      ) {\n        ret[key] = accVal.value;\n      } else {\n        ret[key] = accVal;\n      }\n    });\n    return ret;\n  };\n\n  const pluck = (acc, val) => {\n    const variableType = getNodeType(val);\n    const attrs = getProperties(val) || {};\n\n    if (!attrs.name || !attrs.value) return attrs;\n\n    const nameValue = attrs.name.value;\n    const valueType = attrs.value.type;\n    const valueValue = attrs.value.value;\n\n    switch (valueType) {\n      case 'value':\n        acc[nameValue] = valueValue;\n        break;\n      case 'variable':\n        if (context.hasOwnProperty(valueValue)) {\n          acc[nameValue] = context[valueValue];\n        } else {\n          acc[nameValue] = evalExpression(context, expr);\n        }\n        break;\n      case 'expression':\n        const expr = valueValue;\n        if (variableType === 'var') {\n          acc[nameValue] = evalExpression(\n            Object.assign({}, context, formatAccumulatedValues(acc)),\n            expr\n          );\n        } else {\n          acc[nameValue] = {\n            value: evalExpression(\n              Object.assign({}, context, formatAccumulatedValues(acc)),\n              expr\n            ),\n            update: (newState, oldState, context = {}) => {\n              return evalExpression(\n                Object.assign({}, oldState, newState, context),\n                expr\n              );\n            }\n          };\n        }\n    }\n    return acc;\n  };\n\n  return arr.reduce(pluck, {});\n};\n\nexport const filterIdyllProps = (props, filterInjected) => {\n  const {\n    __vars__,\n    __expr__,\n    idyllASTNode,\n    hasHook,\n    initialState,\n    isHTMLNode,\n    refName,\n    onEnterViewFully,\n    onEnterView,\n    onExitViewFully,\n    onExitView,\n    fullWidth,\n    ...rest\n  } = props;\n  if (filterInjected) {\n    const { idyll, hasError, updateProps, ...ret } = rest;\n    return ret;\n  }\n  return rest;\n};\nexport const getData = (arr, datasets = {}) => {\n  const pluck = (acc, val) => {\n    const nameValue = getProperties(val).name.value;\n    const sourceValue = getProperties(val).source.value;\n    const async = getProperties(val).async\n      ? getProperties(val).async.value\n      : false;\n    if (async) {\n      const initialValue = getProperties(val).initialValue\n        ? JSON.parse(getProperties(val).initialValue.value)\n        : [];\n\n      let dataPromise = new Promise(res => res(initialValue));\n\n      if (typeof fetch !== 'undefined') {\n        dataPromise = fetch(sourceValue)\n          .then(res => {\n            if (res.status >= 400) {\n              throw new Error(\n                `Error Status ${\n                  res.status\n                } occurred while fetching data from ${sourceValue}. If you are using a file to load the data and not a url, make sure async is not set to true.`\n              );\n            }\n            if (sourceValue.endsWith('.csv')) {\n              return res\n                .text()\n                .then(resString =>\n                  parse(resString, {\n                    cast: true,\n                    columns: true,\n                    skip_empty_lines: true,\n                    ltrim: true,\n                    rtrim: true\n                  })\n                )\n                .catch(e => {\n                  console.error(`Error while parsing csv: ${e}`);\n                });\n            }\n            return res.json().catch(e => console.error(e));\n          })\n          .catch(e => {\n            console.error(e);\n          });\n      } else if (typeof window !== 'undefined') {\n        console.warn('Could not find fetch.');\n      }\n      acc.asyncData[nameValue] = {\n        initialValue,\n        dataPromise\n      };\n    } else {\n      acc.syncData[nameValue] = datasets[nameValue];\n    }\n\n    return acc;\n  };\n\n  return arr.reduce(pluck, { syncData: {}, asyncData: {} });\n};\n\nexport const splitAST = ast => {\n  const state = {\n    vars: [],\n    derived: [],\n    data: [],\n    elements: []\n  };\n\n  const handleNode = storeElements => {\n    return node => {\n      const type = getNodeType(node);\n      const children = getChildren(node);\n      if (type === 'var') {\n        state.vars.push(node);\n      } else if (state[type]) {\n        state[type].push(node);\n      } else if (storeElements) {\n        state.elements.push(node);\n      }\n      if (!children || (children.length === 1 && isTextNode(children[0]))) {\n        return;\n      }\n      children.forEach(handleNode(false));\n    };\n  };\n\n  ast.forEach(handleNode(true));\n  return state;\n};\n\n//Properties that add logic to components for callbacks.\nexport const hooks = [\n  'onEnterView',\n  'onEnterViewFully',\n  'onExitView',\n  'onExitViewFully'\n];\n\nexport const scrollMonitorEvents = {\n  onEnterView: 'enterViewport',\n  onEnterViewFully: 'fullyEnterViewport',\n  onExitView: 'partiallyExitViewport',\n  onExitViewFully: 'exitViewport'\n};\n\nexport const translate = ast => {\n  const attrConvert = (props, node) => {\n    let reducedProps = {\n      idyllASTNode: node\n    };\n    for (let propName in props) {\n      const name = propName;\n      const type = props[propName].type;\n      const value = props[propName].value;\n      if (type == 'variable') {\n        if (!reducedProps.__vars__) {\n          reducedProps.__vars__ = {};\n        }\n        reducedProps.__vars__[name] = value;\n      }\n      if (type == 'expression') {\n        if (!reducedProps.__expr__) {\n          reducedProps.__expr__ = {};\n        }\n        reducedProps.__expr__[name] = value;\n      }\n\n      if (hooks.includes(name)) {\n        reducedProps.hasHook = true;\n      }\n\n      reducedProps[name] = value;\n    }\n    return reducedProps;\n  };\n  const tNode = node => {\n    if (isTextNode(node)) return node;\n\n    let name = getNodeName(node);\n\n    let attrs = getProperties(node);\n    if (!attrs) {\n      attrs = {};\n    }\n    const children = getChildren(node);\n    return {\n      component: name,\n      ...attrConvert(attrs, node),\n      children: children.map(tNode)\n    };\n  };\n\n  return splitAST(getChildren(ast)).elements.map(tNode);\n};\n\nexport const mapTree = (tree, mapFn, filterFn = () => true, depth = 0) => {\n  const walkFn = depth => (acc, node) => {\n    //To check for textnodes\n    if (node.component) {\n      //To check for children\n      if (node.children) {\n        node.children = node.children.reduce(walkFn(depth + 1), []);\n      }\n    }\n\n    if (filterFn(node)) {\n      acc.push(mapFn(node, depth));\n    }\n    return acc;\n  };\n  let value = tree.reduce(walkFn(depth), []);\n  return value;\n};\n\nexport const filterASTForDocument = ast => {\n  return removeNodes(cloneNode(ast), node => getNodeName(node) === 'meta');\n};\n\nexport const findWrapTargets = (schema, state, components) => {\n  //Custom components\n  const targets = [];\n  //Name of custom components\n  const componentNames = Object.keys(components);\n\n  componentNames.forEach((component, i) => {\n    let words = component.split('-');\n    for (let i = 0; i < words.length; i++) {\n      words[i] = words[i].charAt(0).toUpperCase() + words[i].substring(1);\n    }\n    componentNames[i] = words.join('').toLowerCase();\n  });\n\n  //Array of keys for the runtime state passed.\n  const stateKeys = Object.keys(state);\n\n  //Populating target with the custom components\n  //Walk the whole tree, collect and return the nodes\n  //for wrapping\n  mapTree(schema, node => {\n    if (node.component === 'textnode') {\n      return node;\n    }\n\n    //Custom components will have hooks attached to them\n    if (node.hasHook) {\n      targets.push(node);\n      return node;\n    }\n\n    if (node.component) {\n      const checkName = node.component\n        .toLowerCase()\n        .split('-')\n        .join('');\n      if (componentNames.includes(checkName)) {\n        targets.push(node);\n        return node;\n      }\n    }\n\n    const { component, children, __vars__, __expr__, ...props } = node;\n\n    const expressions = Object.keys(__expr__ || {});\n    const variables = Object.keys(__vars__ || {});\n\n    for (let prop in props) {\n      if (variables.includes(prop) || expressions.includes(prop)) {\n        targets.push(node);\n        return node;\n      }\n    }\n    return node;\n  });\n\n  return targets;\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport scrollparent from 'scrollparent';\nimport scrollMonitor from 'scrollmonitor';\nimport ReactJsonSchema from './utils/schema2element';\nimport entries from 'object.entries';\nimport values from 'object.values';\nimport { generatePlaceholder } from './components/placeholder';\nimport AuthorTool from './components/author-tool';\nimport { getChildren } from 'idyll-ast';\nimport equal from 'fast-deep-equal';\n\nimport * as layouts from 'idyll-layouts';\nimport * as themes from 'idyll-themes';\n\nimport {\n  getData,\n  getVars,\n  filterASTForDocument,\n  splitAST,\n  translate,\n  findWrapTargets,\n  filterIdyllProps,\n  mapTree,\n  evalExpression,\n  hooks,\n  scrollMonitorEvents\n} from './utils';\n\nconst updatePropsCallbacks = [];\nconst updateRefsCallbacks = [];\nconst scrollWatchers = [];\nconst scrollOffsets = {};\nconst refCache = {};\nconst evalContext = {};\nlet scrollContainer;\n\nconst getLayout = layout => {\n  return layouts[layout.trim()] || {};\n};\n\nconst getTheme = theme => {\n  return themes[theme.trim()] || {};\n};\n\nconst getRefs = () => {\n  const refs = {};\n  if (!scrollContainer) {\n    return refCache;\n  }\n\n  scrollWatchers.forEach(watcher => {\n    // left and right props assume no horizontal scrolling\n    const {\n      watchItem,\n      callbacks,\n      container,\n      recalculateLocation,\n      offsets,\n      ...watcherProps\n    } = watcher;\n    refs[watchItem.dataset.ref] = {\n      ...watcherProps,\n      ...refCache[watchItem.dataset.ref],\n      domNode: watchItem\n    };\n  });\n\n  return { ...refCache, ...refs };\n};\n\nlet wrapperKey = 0;\nconst createWrapper = ({\n  theme,\n  layout,\n  authorView,\n  textEditComponent,\n  userViewComponent,\n  userInlineViewComponent,\n  wrapTextComponents\n}) => {\n  return class Wrapper extends React.PureComponent {\n    constructor(props) {\n      super(props);\n\n      this.key = wrapperKey++;\n      this.ref = {};\n      this.onUpdateRefs = this.onUpdateRefs.bind(this);\n      this.onUpdateProps = this.onUpdateProps.bind(this);\n\n      const vars = values(props.__vars__);\n      const exps = values(props.__expr__);\n\n      this.usesRefs = exps.some(v => v && v.includes('refs.'));\n\n      this.state = { hasError: false, error: null };\n\n      // listen for props updates IF we care about them\n      if (vars.length || exps.length) {\n        // called with new doc state\n        // when any component calls updateProps()\n        updatePropsCallbacks.push(this.onUpdateProps);\n        this.state = this.onUpdateProps(\n          props.initialState,\n          Object.keys(props),\n          true\n        );\n      }\n\n      // listen for ref updates IF we care about them\n      if (props.hasHook || this.usesRefs) {\n        updateRefsCallbacks.push(this.onUpdateRefs);\n      }\n    }\n\n    componentDidCatch(error, info) {\n      this.setState({ hasError: true, error: error });\n    }\n\n    onUpdateProps(newState, changedKeys, initialRender) {\n      const { __vars__, __expr__ } = this.props;\n\n      // were there changes to any vars we track?\n      // or vars our expressions reference?\n      const shouldUpdate =\n        initialRender ||\n        changedKeys.some(k => {\n          return (\n            values(__vars__).includes(k) ||\n            values(__expr__).some(expr => expr.includes(k))\n          );\n        });\n      // if nothing we care about changed bail out and don't re-render\n      if (!shouldUpdate) return;\n\n      // update this component's state\n      const nextState = {};\n      // pull in the latest value for any tracked vars\n      Object.keys(__vars__).forEach(key => {\n        nextState[key] = newState[__vars__[key]];\n      });\n      // re-run this component's expressions using the latest doc state\n      Object.keys(__expr__).forEach(key => {\n        nextState[key] = evalExpression(\n          { ...newState, refs: getRefs() },\n          __expr__[key],\n          key,\n          evalContext\n        );\n      });\n\n      if (initialRender) {\n        return Object.assign({ hasError: false }, nextState);\n      }\n      // trigger a re-render of this component\n      // and more importantly, its wrapped component\n      this.setState(Object.assign({ hasError: false, error: null }, nextState));\n    }\n\n    onUpdateRefs(newState) {\n      const { __expr__ } = this.props;\n\n      if (this.usesRefs) {\n        const nextState = { refs: newState.refs };\n        entries(__expr__).forEach(([key, val]) => {\n          if (!val.includes('refs.')) {\n            return;\n          }\n          nextState[key] = evalExpression(newState, val, key, evalContext);\n        });\n\n        // trigger a render with latest state\n        this.setState(nextState);\n      }\n    }\n\n    componentWillUnmount() {\n      const propsIndex = updatePropsCallbacks.indexOf(this.onUpdateProps);\n      if (propsIndex > -1) updatePropsCallbacks.splice(propsIndex, 1);\n\n      const refsIndex = updateRefsCallbacks.indexOf(this.onUpdateRefs);\n      if (refsIndex > -1) updateRefsCallbacks.splice(refsIndex, 1);\n    }\n\n    render() {\n      const state = filterIdyllProps(this.state, this.props.isHTMLNode);\n      const { children, ...passThruProps } = filterIdyllProps(\n        this.props,\n        this.props.isHTMLNode\n      );\n      let childComponent = null;\n      let uniqueKey = `${this.key}-help`;\n      let returnComponent = React.Children.map(children, (c, i) => {\n        childComponent = c;\n        return React.cloneElement(c, {\n          key: `${this.key}-${i}`,\n          idyll: {\n            theme: getTheme(theme),\n            layout: getLayout(layout),\n            authorView: authorView\n          },\n          ...state,\n          ...passThruProps\n        });\n      });\n      if (this.state.hasError) {\n        returnComponent = (\n          <div style={{ border: 'solid red 1px', padding: 10 }}>\n            {this.state.error.message}\n          </div>\n        );\n      }\n      const metaData = childComponent.type._idyll;\n      if (authorView) {\n        // ensure inline elements do not have this overlay\n        if (\n          (metaData && metaData.name === 'TextContainer') ||\n          ['TextContainer', 'DragDropContainer'].includes(\n            childComponent.type.name\n          )\n        ) {\n          return returnComponent;\n        } else if (\n          textEditComponent &&\n          metaData &&\n          wrapTextComponents.includes(metaData.name.toLowerCase())\n        ) {\n          const ViewComponent = textEditComponent;\n          return (\n            <ViewComponent idyllASTNode={this.props.idyllASTNode}>\n              {childComponent}\n            </ViewComponent>\n          );\n        } else if (\n          !metaData ||\n          metaData.displayType === undefined ||\n          metaData.displayType !== 'inline'\n        ) {\n          const ViewComponent = userViewComponent || AuthorTool;\n          return (\n            <ViewComponent\n              idyllASTNode={this.props.idyllASTNode}\n              component={returnComponent}\n              authorComponent={childComponent}\n              uniqueKey={uniqueKey}\n            />\n          );\n        } else if (metaData.displayType === 'inline') {\n          const InlineViewComponent =\n            userInlineViewComponent || userViewComponent || AuthorTool;\n          return (\n            <InlineViewComponent\n              idyllASTNode={this.props.idyllASTNode}\n              component={returnComponent}\n              authorComponent={childComponent}\n              uniqueKey={uniqueKey}\n            />\n          );\n        }\n      }\n      return returnComponent;\n    }\n  };\n};\n\nconst getDerivedValues = dVars => {\n  const o = {};\n  Object.keys(dVars).forEach(key => (o[key] = dVars[key].value));\n  return o;\n};\n\nclass IdyllRuntime extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this.scrollListener = this.scrollListener.bind(this);\n    this.initScrollListener = this.initScrollListener.bind(this);\n    const ast = filterASTForDocument(props.ast);\n\n    const { vars, derived, data, elements } = splitAST(getChildren(ast));\n    const Wrapper = createWrapper({\n      theme: props.theme,\n      layout: props.layout,\n      authorView: props.authorView,\n      textEditComponent: props.textEditComponent,\n      userViewComponent: props.userViewComponent,\n      userInlineViewComponent: props.userInlineViewComponent,\n      wrapTextComponents: props.wrapTextComponents\n    });\n\n    let hasInitialized = false;\n    let initialContext = {};\n    // Initialize a custom context\n    let _initializeCallbacks = [];\n    let _mountCallbacks = [];\n    let _updateCallbacks = [];\n\n    this._onInitializeState = () => {\n      _initializeCallbacks.forEach(cb => {\n        cb();\n      });\n    };\n    this._onMount = () => {\n      _mountCallbacks.forEach(cb => {\n        cb();\n      });\n    };\n    this._onUpdateState = newData => {\n      _updateCallbacks.forEach(cb => {\n        cb(newData);\n      });\n    };\n    if (typeof props.context === 'function') {\n      props.context({\n        update: newState => {\n          if (!hasInitialized) {\n            initialContext = Object.assign(initialContext, newState);\n          } else {\n            this.updateState(newState);\n          }\n        },\n        data: () => {\n          return this.state;\n        },\n        onInitialize: cb => {\n          _initializeCallbacks.push(cb);\n        },\n        onMount: cb => {\n          _mountCallbacks.push(cb);\n        },\n        onUpdate: cb => {\n          _updateCallbacks.push(cb);\n        }\n      });\n    }\n\n    const dataStore = getData(data, props.datasets);\n    const initialState = Object.assign(\n      {},\n      {\n        ...getVars(vars, initialContext),\n        ...dataStore.syncData\n      },\n      initialContext,\n      props.initialState ? props.initialState : {}\n    );\n\n    const { asyncData: asyncDataStore } = dataStore;\n    const asyncDataStoreKeys = Object.keys(asyncDataStore);\n    asyncDataStoreKeys.forEach(key => {\n      this.state[key] = asyncDataStore[key].initialValue;\n    });\n\n    asyncDataStoreKeys.map(key => {\n      asyncDataStore[key].dataPromise\n        .then(res => {\n          this.updateState({\n            ...this.state,\n            [key]: res\n          });\n        })\n        .catch(e => console.error('Error while resolving the data' + e));\n    });\n    const derivedVars = (this.derivedVars = getVars(derived, initialState));\n\n    let state = (this.state = {\n      ...this.state,\n      ...initialState,\n      ...getDerivedValues(derivedVars)\n    });\n\n    this.updateState = newState => {\n      // merge new doc state with old\n      const newMergedState = { ...this.state, ...newState };\n      // update derived values\n      const newDerivedValues = getDerivedValues(\n        getVars(derived, newMergedState)\n      );\n      const nextState = { ...newMergedState, ...newDerivedValues };\n\n      const changedMap = {};\n      const changedKeys = Object.keys(state).reduce((acc, k) => {\n        if (!equal(state[k], nextState[k])) {\n          acc.push(k);\n          changedMap[k] = nextState[k] || state[k];\n        }\n        return acc;\n      }, []);\n\n      // Update doc state reference.\n      // We re-use the same object here so that\n      // IdyllRuntime.state can be accurately checked in tests\n      state = Object.assign(state, nextState);\n      // pass the new doc state to all listeners aka component wrappers\n      updatePropsCallbacks.forEach(f => f(state, changedKeys));\n\n      changedKeys.length &&\n        this._onUpdateState &&\n        this._onUpdateState(changedMap);\n    };\n\n    evalContext.__idyllUpdate = this.updateState;\n    hasInitialized = true;\n    this._onInitializeState && this._onInitializeState();\n\n    // Put these in to avoid hard errors if people are on the latest\n    // CLI but haven't updated their local default components\n    const fallbackComponents = {\n      'text-container': generatePlaceholder('TextContainer'),\n      'full-width': generatePlaceholder('FullWidth')\n    };\n\n    // Components that the Document needs to function properly\n    const internalComponents = {\n      Wrapper\n    };\n\n    Object.keys(internalComponents).forEach(key => {\n      if (props.components[key]) {\n        console.warn(\n          `Warning! You are including a component named ${key}, but this is a reserved Idyll component. Please rename your component.`\n        );\n      }\n    });\n\n    const components = Object.assign(\n      fallbackComponents,\n      props.components,\n      internalComponents\n    );\n\n    const rjs = new ReactJsonSchema(components);\n    const schema = translate(ast);\n    const wrapTargets = findWrapTargets(schema, this.state, props.components);\n    let refCounter = 0;\n    const transformedSchema = mapTree(schema, (node, depth) => {\n      // console.log('mapoing ', node.component || node.type);\n      if (!node.component) {\n        if (node.type && node.type === 'textnode') return node.value;\n      }\n\n      // transform refs from strings to functions and store them\n      if (node.ref || node.hasHook) {\n        node.refName = node.ref || node.component + (refCounter++).toString();\n        node.ref = el => {\n          if (!el) return;\n          const domNode = ReactDOM.findDOMNode(el);\n          domNode.dataset.ref = node.refName;\n          scrollOffsets[node.refName] = node.scrollOffset || 0;\n          refCache[node.refName] = {\n            props: node,\n            domNode: domNode,\n            component: el\n          };\n        };\n        refCache[node.refName] = {\n          props: node,\n          domNode: null\n        };\n      }\n      //Inspect for isHTMLNode  props and to check for dynamic components.\n      if (!wrapTargets.includes(node)) {\n        if (\n          this.props.wrapTextComponents.indexOf(node.component) > -1 &&\n          this.props.textEditComponent\n        ) {\n          const { idyllASTNode, ...rest } = node;\n          return {\n            component: this.props.textEditComponent,\n            idyllASTNode: idyllASTNode,\n            children: [rest]\n          };\n        }\n\n        // Don't include the AST node reference on unwrapped components\n        const { idyllASTNode, ...rest } = node;\n        return rest;\n      }\n      let {\n        component,\n        children,\n        idyllASTNode,\n        key,\n        __vars__,\n        __expr__,\n        ...props // actual component props\n      } = node;\n      __vars__ = __vars__ || {};\n      __expr__ = __expr__ || {};\n\n      // assign the initial values for tracked vars and expressions\n      Object.keys(props).forEach(k => {\n        if (__vars__[k]) {\n          node[k] = state[__vars__[k]];\n        }\n        if (__expr__[k] !== undefined) {\n          if (hooks.indexOf(k) > -1) {\n            return;\n          }\n          node[k] = evalExpression(\n            { ...state, refs: getRefs() },\n            __expr__[k],\n            k,\n            evalContext\n          );\n        }\n      });\n      const resolvedComponent = rjs.resolveComponent(node);\n      const isHTMLNode = typeof resolvedComponent === 'string';\n\n      return {\n        component: Wrapper,\n        __vars__,\n        __expr__,\n        idyllASTNode,\n        isHTMLNode: isHTMLNode,\n        hasHook: node.hasHook,\n        refName: node.refName,\n        initialState: this.state,\n        updateProps: newProps => {\n          // init new doc state object\n          const newState = {};\n          // iterate over passed in updates\n          Object.keys(newProps).forEach(k => {\n            // if a tracked var was updated get its new value\n            if (__vars__[k]) {\n              newState[__vars__[k]] = newProps[k];\n            }\n          });\n          this.updateState(newState);\n        },\n        children: [filterIdyllProps(node, isHTMLNode)]\n      };\n    });\n\n    this.kids = rjs.parseSchema(transformedSchema);\n  }\n\n  scrollListener() {\n    const refs = getRefs();\n    updateRefsCallbacks.forEach(f => f({ ...this.state, refs }));\n  }\n\n  initScrollListener(el) {\n    if (!el) return;\n\n    let scroller = scrollparent(el);\n    if (\n      scroller === document.documentElement ||\n      scroller === document.body ||\n      scroller === window\n    ) {\n      scroller = window;\n      scrollContainer = scrollMonitor;\n    } else {\n      scrollContainer = scrollMonitor.createContainer(scroller);\n    }\n    Object.keys(refCache).forEach(key => {\n      const { props, domNode } = refCache[key];\n      const watcher = scrollContainer.create(domNode, scrollOffsets[key]);\n      hooks.forEach(hook => {\n        if (props[hook]) {\n          watcher[scrollMonitorEvents[hook]](() => {\n            evalExpression(\n              { ...this.state, refs: getRefs() },\n              props[hook],\n              hook,\n              evalContext\n            )();\n          });\n        }\n      });\n      scrollWatchers.push(watcher);\n    });\n    scroller.addEventListener('scroll', this.scrollListener);\n  }\n\n  updateDerivedVars(newState) {\n    const context = {};\n    Object.keys(this.derivedVars).forEach(dv => {\n      this.derivedVars[dv].value = this.derivedVars[dv].update(\n        newState,\n        this.state,\n        context\n      );\n      context[dv] = this.derivedVars[dv].value;\n    });\n  }\n\n  getDerivedVars() {\n    let dvs = {};\n    Object.keys(this.derivedVars).forEach(dv => {\n      dvs[dv] = this.derivedVars[dv].value;\n    });\n    return dvs;\n  }\n\n  componentDidMount() {\n    const refs = getRefs();\n    updateRefsCallbacks.forEach(f => f({ ...this.state, refs }));\n    this._onMount && this._onMount();\n  }\n\n  render() {\n    return (\n      <div className=\"idyll-root\" ref={this.initScrollListener}>\n        {this.kids}\n      </div>\n    );\n  }\n}\n\nIdyllRuntime.defaultProps = {\n  layout: 'blog',\n  theme: 'github',\n  authorView: false,\n  insertStyles: false,\n  wrapTextComponents: [\n    'p',\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    'ul',\n    'ol',\n    'pre',\n    'CodeHighlight'\n  ]\n};\n\nexport default IdyllRuntime;\n","import React from 'react';\nimport Runtime from './runtime';\nimport compile from 'idyll-compiler';\nimport * as layouts from 'idyll-layouts';\nimport * as themes from 'idyll-themes';\n\nconst getLayout = layout => {\n  return layouts[layout.trim()] || {};\n};\n\nconst getTheme = theme => {\n  return themes[theme.trim()] || {};\n};\n\nlet layoutNode;\nlet themeNode;\n\nconst defaultAST = {\n  id: 0,\n  type: 'component',\n  name: 'root'\n};\n\nconst hashCode = str => {\n  var hash = 0,\n    i,\n    chr;\n  if (str.length === 0) return hash;\n  for (i = 0; i < str.length; i++) {\n    chr = str.charCodeAt(i);\n    hash = (hash << 5) - hash + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n};\n\nclass IdyllDocument extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ast: props.ast || defaultAST,\n      previousAST: props.ast || defaultAST,\n      hash: props.ast ? JSON.stringify(props.ast) : '',\n      error: null\n    };\n  }\n\n  createStyleNode(str) {\n    var node = document.createElement('style');\n    node.innerHTML = str;\n    document.body.appendChild(node);\n    return node;\n  }\n\n  componentDidMount() {\n    if (!this.props.ast && this.props.markup) {\n      compile(this.props.markup, this.props.compilerOptions).then(ast => {\n        this.setState({ ast, hash: hashCode(this.props.markup), error: null });\n      });\n    }\n\n    if (this.props.injectThemeCSS) {\n      if (themeNode) {\n        themeNode.innerHTML = getTheme(this.props.theme).styles;\n      } else {\n        themeNode = this.createStyleNode(getTheme(this.props.theme).styles);\n      }\n    }\n    if (this.props.injectLayoutCSS) {\n      if (layoutNode) {\n        layoutNode.innerHTML = getLayout(this.props.layout).styles;\n      } else {\n        layoutNode = this.createStyleNode(getLayout(this.props.layout).styles);\n      }\n    }\n  }\n\n  componentDidCatch(error, info) {\n    this.props.onError && this.props.onError(error);\n    this.setState({ error: error.message });\n  }\n\n  UNSAFE_componentWillReceiveProps(newProps) {\n    if (newProps.theme !== this.props.theme && newProps.injectThemeCSS) {\n      if (themeNode) {\n        themeNode.innerHTML = getTheme(newProps.theme).styles;\n      } else {\n        themeNode = this.createStyleNode(getTheme(newProps.theme).styles);\n      }\n    }\n    if (newProps.layout !== this.props.layout && newProps.injectLayoutCSS) {\n      if (layoutNode) {\n        layoutNode.innerHTML = getLayout(newProps.layout).styles;\n      } else {\n        layoutNode = this.createStyleNode(getLayout(newProps.layout).styles);\n      }\n    }\n\n    if (newProps.ast) {\n      this.setState({ hash: JSON.stringify(newProps.ast) });\n      return;\n    }\n\n    const hash = hashCode(newProps.markup);\n    if (hash !== this.state.hash) {\n      this.setState({ previousAST: this.state.ast });\n      compile(newProps.markup, newProps.compilerOptions)\n        .then(ast => {\n          this.setState({ previousAST: ast, ast, hash, error: null });\n        })\n        .catch(this.componentDidCatch.bind(this));\n    }\n  }\n\n  getErrorComponent() {\n    if (!this.state.error) {\n      return null;\n    }\n    return React.createElement(\n      this.props.errorComponent || 'pre',\n      {\n        className: 'idyll-document-error'\n      },\n      this.state.error\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <Runtime\n          {...this.props}\n          key={this.state.hash}\n          context={context => {\n            this.idyllContext = context;\n            typeof this.props.context === 'function' &&\n              this.props.context(context);\n          }}\n          initialState={\n            this.props.initialState ||\n            (this.idyllContext ? this.idyllContext.data() : {})\n          }\n          ast={this.props.ast || this.state.ast}\n        />\n        {this.getErrorComponent()}\n      </div>\n    );\n  }\n}\n\nexport default IdyllDocument;\n"],"names":["_componentMap","WeakMap","ReactJsonSchema","componentMap","_classCallCheck","setComponentMap","schema","element","elements","Array","isArray","parseSubSchemas","createComponent","subSchemas","Components","index","subSchema","push","key","parseSchema","type","value","component","children","rest","_excluded","Component","resolveComponent","Children","resolveComponentChildren","createElement","getComponentMap","hasOwnProperty","Error","Object","split","_toArray","name","subs","paramCase","pascalCase","i","length","DOM","console","warn","React","color","border","undefined","get","set","generatePlaceholder","_inherits","_createSuper","props","_createClass","idyll","updateProps","hasError","_objectWithoutProperties","PureComponent","AuthorTool","state","isAuthorView","debugHeight","componentHeight","hasPressedButton","handleClick","bind","_assertThisInitialized","metaValues","runtimeValues","map","prop","runtimeValue","currentPropValue","toString","call","JSON","stringify","example","_idyll","componentName","componentLowerCase","charAt","toLowerCase","slice","componentDocsLink","showProps","handleTableValues","currentDebugHeight","marginToGive","marginAboveTable","height","marginBottom","marginTop","inner","innerHeight","fontFamily","fontSize","setState","prevState","getBoundingClientRect","_refContainer","addBorder","boxShadow","transition","padding","margin","putButtonBack","right","top","ref","uniqueKey","ReactTooltip","authorComponent","handleFormatComponent","require","cloneNode","getChildren","getNodeName","getNodeType","getProperties","isTextNode","removeNodes","isPropertyAccess","node","parent","source","indexOf","proxyString","substr","isObjectKey","buildExpression","acc","expr","isEventHandler","identifiers","modifiedExpression","falafel","skip","keys","update","e","error","join","filter","evalExpression","context","match","eval","assign","__idyllCopy","copy","o","_typeof","output","v","evalString","err","getVars","arr","formatAccumulatedValues","ret","forEach","accVal","pluck","val","variableType","attrs","nameValue","valueType","valueValue","newState","oldState","reduce","filterIdyllProps","filterInjected","__vars__","__expr__","idyllASTNode","hasHook","initialState","isHTMLNode","refName","onEnterViewFully","onEnterView","onExitViewFully","onExitView","fullWidth","_excluded2","getData","datasets","sourceValue","async","initialValue","parse","dataPromise","Promise","res","fetch","then","status","endsWith","text","resString","cast","columns","skip_empty_lines","ltrim","rtrim","json","window","asyncData","syncData","splitAST","ast","vars","derived","data","handleNode","storeElements","hooks","scrollMonitorEvents","translate","attrConvert","reducedProps","propName","includes","tNode","_objectSpread","mapTree","tree","mapFn","filterFn","depth","walkFn","filterASTForDocument","findWrapTargets","components","targets","componentNames","words","toUpperCase","substring","checkName","_excluded3","expressions","variables","updatePropsCallbacks","updateRefsCallbacks","scrollWatchers","scrollOffsets","refCache","evalContext","scrollContainer","getLayout","layout","layouts","trim","getTheme","theme","themes","getRefs","refs","watcher","watchItem","callbacks","container","recalculateLocation","offsets","watcherProps","dataset","domNode","wrapperKey","createWrapper","authorView","textEditComponent","userViewComponent","userInlineViewComponent","wrapTextComponents","onUpdateRefs","onUpdateProps","values","exps","usesRefs","some","info","changedKeys","initialRender","shouldUpdate","k","nextState","entries","_slicedToArray","propsIndex","splice","refsIndex","passThruProps","childComponent","returnComponent","c","cloneElement","message","metaData","ViewComponent","displayType","InlineViewComponent","getDerivedValues","dVars","IdyllRuntime","scrollListener","initScrollListener","Wrapper","hasInitialized","initialContext","_initializeCallbacks","_mountCallbacks","_updateCallbacks","_onInitializeState","cb","_onMount","_onUpdateState","newData","updateState","onInitialize","onMount","onUpdate","dataStore","asyncDataStore","asyncDataStoreKeys","derivedVars","newMergedState","newDerivedValues","changedMap","equal","f","__idyllUpdate","fallbackComponents","internalComponents","rjs","wrapTargets","refCounter","transformedSchema","el","ReactDOM","findDOMNode","scrollOffset","resolvedComponent","newProps","kids","scroller","scrollparent","document","documentElement","body","scrollMonitor","createContainer","create","hook","addEventListener","dv","dvs","defaultProps","insertStyles","layoutNode","themeNode","defaultAST","id","hashCode","str","hash","chr","charCodeAt","IdyllDocument","previousAST","innerHTML","appendChild","markup","compile","compilerOptions","injectThemeCSS","styles","createStyleNode","injectLayoutCSS","onError","componentDidCatch","errorComponent","className","Runtime","_extends","idyllContext","getErrorComponent"],"mappings":"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"}